name: Python Code Quality Checks

on:
  pull_request:
    branches:
      - main 
    # Only run the workflow if files in these specific Python directories are changed
    paths:
      - 'python/agents/**.py'
      - 'python/notebooks/**.py'
      - 'python/notebooks/**.ipynb'
      
jobs:
  python-checks:
    runs-on: ubuntu-latest

    steps:
      - name: ‚¨áÔ∏è Checkout Repository
        uses: actions/checkout@v4

      - name: üêç Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11' 

      - name: ‚öôÔ∏è Install Tools (Matching Makefile)
        run: pip install black flake8 isort nbqa

      # --- Black/iSort Check for .py files ---
      - name: üìù Run Black and iSort Checks
        run: |
          black --check --diff python/agents/ python/notebooks/
          isort --check-only --diff python/agents/ python/notebooks/

      # --- Flake8 Check for all .py files ---
      - name: üßπ Run Flake8 Linting
        run: flake8 ./python/

      # --- Black/iSort Check for .ipynb files (using nbqa) ---
      - name: üìì Check Notebooks (nbqa)
        run: |
          nbqa black --check --diff python/notebooks/
          nbqa isort --check-only --diff python/notebooks/